/**
 * 
 */
$(function() {

	const cPath = $(".sidebar-sticky").data("contextPath");

	let makeLiTag = function(lectureVO) {
		let trTag = `
			<li class="nav-item">
				<p class="nav-link active" data-lecture-code='${lectureVO.lecCd}'>${lectureVO.subjectVO.subName}</p>
			</li>
			`;
		return trTag;
	}; //makeTags end


	const baseUrl = `${cPath}/professor`;

	$.getJSON(baseUrl, function(resp) {
		let lectureList = resp.lectureList;
		trTags = "";
		if (lectureList?.length > 0) {			//adrList가 있고 length가 0보다 크다
			$.each(lectureList, function() {
				trTags += makeLiTag(this);
			});
		} else {
			trTags += `
			<li class="nav-item">
				현재 강의중인 목록이 없습니다.
			</li>
			`;
		}// if ~ else end

		$("#lectureList").html(trTags);
	});// getJSON end



	$(document).on("click", ".nav-link", function() {
		let listUrl = `${baseUrl}/studentList`;
		var lecCode = $(this).data("lectureCode");

		$.ajax({
			url:listUrl,
			type:'get',
			dataType:'json',
			data: { 'lecCode': lecCode },
			success:function(resp) {

				let student = resp.studentList;
				let trTag = "";

				if (student.length != 0) {
					$.each(student, function(i,v) {
						trTag += `
							<tr>
								<td>${v.lectureVO.subCd}</td>
								<td>${v.studentVO.stdNo}</td>
								<td>${v.studentVO.stdName}</td>
								<td>${v.studentVO.stdId}</td>
								<td>${v.studentVO.stdTelno}</td>
								<td>${v.studentVO.stdAdd}</td>
								<td><input data-bs-toggle="modal" data-bs-target="#exampleModal" class="btn btn-danger" type="button" value="학점관리"/></td>
							</tr>
						`;
					})//$.each
					$("#studentListBody").html(trTag);
				} else {
					trTag += `
						<tr>
							<td colspan="5">수강중인 학생이 없습니다.</td>
						</tr>
					`;
				}
			},
			error:function(xhr) {
				alert("status : " + xhr.status);
			}
		});

		
	});
	

$(exampleModal).on("hidden.bs.modal",function(){
	$(this).find("form")[0].reset();
});


});