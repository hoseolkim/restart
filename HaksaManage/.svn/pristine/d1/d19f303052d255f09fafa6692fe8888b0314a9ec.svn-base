/**
 * 
 */
$(()=>{
	const cPath = $(document.body).data('contextPath');
	$('#lectureList').parents('div').removeClass('d-flex');
	
	
	$.getJSON(`${cPath}/student`)
		.done(function(resp){
			trTags = "";
			mytrTags = "";
			let list = resp.lectureList;
			let myList = resp.myList;
			if(list.length > 0){
				$.each(list,function(i,v){
					trTags += makeLectureListTrTag(v);
				})
			}else{
				trTags = "<tr><td colspan='8'>수강신청 가능한 강의 목록이 없습니다.</td></tr>"
			}
			if(myList.length > 0){
				$.each(myList,function(i,v){
					mytrTags += makeMyListTrTag(v);
				})
			}else{
				mytrTags = "<tr><td colspan='8'>수강신청한 강의 목록이 없습니다.</td></tr>"
			}
			$('#lectureList').html(trTags);
			$('#currList').html(mytrTags);
		});
})
const weeks = ["월","화","수","목","금"];

var makeLectureListTrTag = (lectureVO) =>{
	let code = `<tr data-lec-cd="${lectureVO.lecCd}">`;
	if(lectureVO.currPerson == lectureVO.lecPerson){
		code += `<td><span class="text-red">수강인원제한</span></td>`;
	}else{
		code += `<td><button type="button" class="enrollBtn">수강신청</button></td>`;
	}
	code +=`
		<td>${lectureVO.subjectVO.subGrade}</td>
		<td>${lectureVO.subjectVO.subName}</td>
		<td>${lectureVO.professorVO.proName}</td>
		<td>${lectureVO.lecRoom}</td>
		<td>${lectureVO.lecTime}</td>
		<td>${weeks[lectureVO.lecWeek-1]}</td>
		<td>${lectureVO.lecPerson}</td>
		<td>${lectureVO.currPerson}</td>
	</tr>
	`;
	return code;
}
var makeMyListTrTag = (lectureVO) =>{
	let code = `<tr data-lec-cd="${lectureVO.lecCd}">`;
	code += `<td><button type="button" class="cancelBtn">수강 취소</button></td>`;
	code +=`
		<td>${lectureVO.subjectVO.subGrade}</td>
		<td>${lectureVO.subjectVO.subName}</td>
		<td>${lectureVO.professorVO.proName}</td>
		<td>${lectureVO.lecRoom}</td>
		<td>${lectureVO.lecTime}</td>
		<td>${weeks[lectureVO.lecWeek-1]}</td>
		<td>${lectureVO.lecPerson}</td>
		<td>${lectureVO.currPerson}</td>
	</tr>
	`;
	return code;
}